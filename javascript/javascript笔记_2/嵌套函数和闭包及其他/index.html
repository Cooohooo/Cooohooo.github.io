<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>嵌套函数和闭包及其他 | Cary</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="专注于记录一些从开始到入门踩过的坑">
    <link rel="preload" href="/assets/css/0.styles.b8e99327.css" as="style"><link rel="preload" href="/assets/js/app.b1624e8e.js" as="script"><link rel="preload" href="/assets/js/2.12e8692c.js" as="script"><link rel="preload" href="/assets/js/38.635da6e1.js" as="script"><link rel="prefetch" href="/assets/js/10.eff93b86.js"><link rel="prefetch" href="/assets/js/11.793fbf77.js"><link rel="prefetch" href="/assets/js/12.4a71ec38.js"><link rel="prefetch" href="/assets/js/13.093a470d.js"><link rel="prefetch" href="/assets/js/14.c529c00a.js"><link rel="prefetch" href="/assets/js/15.9cc56e10.js"><link rel="prefetch" href="/assets/js/16.f161731c.js"><link rel="prefetch" href="/assets/js/17.438c44df.js"><link rel="prefetch" href="/assets/js/18.c02afc3a.js"><link rel="prefetch" href="/assets/js/19.c4b19fba.js"><link rel="prefetch" href="/assets/js/20.dec86c76.js"><link rel="prefetch" href="/assets/js/21.1b6d07c1.js"><link rel="prefetch" href="/assets/js/22.44c5118e.js"><link rel="prefetch" href="/assets/js/23.4da8ff8e.js"><link rel="prefetch" href="/assets/js/24.fdc9730d.js"><link rel="prefetch" href="/assets/js/25.806070ea.js"><link rel="prefetch" href="/assets/js/26.d8d44464.js"><link rel="prefetch" href="/assets/js/27.03a5f16f.js"><link rel="prefetch" href="/assets/js/28.e9711547.js"><link rel="prefetch" href="/assets/js/29.c20512e0.js"><link rel="prefetch" href="/assets/js/3.964ad172.js"><link rel="prefetch" href="/assets/js/30.ff71561f.js"><link rel="prefetch" href="/assets/js/31.44701f47.js"><link rel="prefetch" href="/assets/js/32.060499f3.js"><link rel="prefetch" href="/assets/js/33.c8f8e25c.js"><link rel="prefetch" href="/assets/js/34.484e7f5b.js"><link rel="prefetch" href="/assets/js/35.d0e86e52.js"><link rel="prefetch" href="/assets/js/36.6e9c597a.js"><link rel="prefetch" href="/assets/js/37.d0ea72cc.js"><link rel="prefetch" href="/assets/js/39.c6c12926.js"><link rel="prefetch" href="/assets/js/4.9e3305df.js"><link rel="prefetch" href="/assets/js/40.77988a3a.js"><link rel="prefetch" href="/assets/js/41.09ced7b0.js"><link rel="prefetch" href="/assets/js/42.f0c83ede.js"><link rel="prefetch" href="/assets/js/43.8433eb78.js"><link rel="prefetch" href="/assets/js/44.9a1d5c63.js"><link rel="prefetch" href="/assets/js/45.cb79a166.js"><link rel="prefetch" href="/assets/js/5.536117a3.js"><link rel="prefetch" href="/assets/js/6.fdeca71c.js"><link rel="prefetch" href="/assets/js/7.b91670df.js"><link rel="prefetch" href="/assets/js/8.53ae3032.js"><link rel="prefetch" href="/assets/js/9.2475cef8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8e99327.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Cary</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  目录
</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  目录
</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>嵌套函数和闭包及其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/javascript/javascript%E7%AC%94%E8%AE%B0_2/%E5%B5%8C%E5%A5%97%E5%87%BD%E6%95%B0%E5%92%8C%E9%97%AD%E5%8C%85%E5%8F%8A%E5%85%B6%E4%BB%96/#嵌套函数和闭包" class="sidebar-link">嵌套函数和闭包</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javascript/javascript%E7%AC%94%E8%AE%B0_2/%E5%B5%8C%E5%A5%97%E5%87%BD%E6%95%B0%E5%92%8C%E9%97%AD%E5%8C%85%E5%8F%8A%E5%85%B6%E4%BB%96/#保存变量" class="sidebar-link">保存变量</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javascript/javascript%E7%AC%94%E8%AE%B0_2/%E5%B5%8C%E5%A5%97%E5%87%BD%E6%95%B0%E5%92%8C%E9%97%AD%E5%8C%85%E5%8F%8A%E5%85%B6%E4%BB%96/#命名冲突" class="sidebar-link">命名冲突</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javascript/javascript%E7%AC%94%E8%AE%B0_2/%E5%B5%8C%E5%A5%97%E5%87%BD%E6%95%B0%E5%92%8C%E9%97%AD%E5%8C%85%E5%8F%8A%E5%85%B6%E4%BB%96/#闭包" class="sidebar-link">闭包</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="嵌套函数和闭包及其他"><a href="#嵌套函数和闭包及其他" class="header-anchor">#</a> 嵌套函数和闭包及其他</h1> <h2 id="嵌套函数和闭包"><a href="#嵌套函数和闭包" class="header-anchor">#</a> 嵌套函数和闭包</h2> <p>你可以在一个函数里面嵌套另外一个函数。嵌套（内部）函数对其容器（外部）函数是私有的。它自身也形成了一个闭包。一个闭包是一个可以自己拥有独立的环境与变量的表达式（通常是函数）<br></p> <p>既然嵌套函数是一个闭包，就意味着一个嵌套函数可以”继承“容器函数的参数和变量。换句话说，内部函数包含外部函数的作用域。 <br></p> <p>闭包可以总结下面两点：</p> <ul><li>内部函数只可以在外部函数中访问</li> <li>内部函数形成了一个闭包：它可以访问外部函数的参数和变量，但是外部函数却不能使用它的参数和变量</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">addSquares</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">square</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">square</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
a <span class="token operator">=</span> <span class="token function">addSquares</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 13</span>
b <span class="token operator">=</span> <span class="token function">addSquares</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 25</span>
c <span class="token operator">=</span> <span class="token function">addSquares</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 41</span>
</code></pre></div><p>由于内部函数形成了闭包，因此你可以调用外部函数并为外部函数和内部函数指定参数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outside</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">inside</span><span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> inside<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 方法一：</span>
fn_inside <span class="token operator">=</span> <span class="token function">outside</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可以这样想：给一个函数，使它的值加3</span>
result <span class="token operator">=</span> <span class="token function">fn_inside</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 8</span>
<span class="token comment">// 方法二：</span>
result1 <span class="token operator">=</span> <span class="token function">outside</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 8</span>
</code></pre></div><h2 id="保存变量"><a href="#保存变量" class="header-anchor">#</a> 保存变量</h2> <p>注意到上例中 inside 被返回时 x 是怎么被保留下来的。一个闭包<font color="red">必须保存它可见作用域中所有参数和变量。</font>因为每一次调用传入的参数都可能不同，每一次对外部函数的调用实际上重新创建了一遍这个闭包。只有当返回的 inside 没有再被引用时，内存才会被释放</p> <h2 id="命名冲突"><a href="#命名冲突" class="header-anchor">#</a> 命名冲突</h2> <p>当同一个闭包作用域下两个参数或者变量同名时，就会产生命名冲突。更近的作用域有更高的优先权，所以最近的优先级最高，最远的优先级最低。这就是作用域链。<font color="red">链的第一个元素就是最里面的作用域</font>，最后一个元素便是最外层的作用域。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outside</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">inside</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> inside<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">outside</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns 20 instead of 10</span>
</code></pre></div><p>命名冲突发生在return x上，inside的参数x和outside变量x发生了冲突。这里的作用链域是{inside, outside, 全局对象}。因此inside的x具有最高优先权，返回了20（inside的x）而不是10（outside的x）</p> <h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <p>闭包是 JavaScript 中最强大的特性之一。JavaScript 允许函数嵌套，并且内部函数可以访问定义在外部函数中的所有变量和函数，以及外部函数能访问的所有变量和函数。但是，外部函数却不能够访问定义在内部函数中的变量和函数。这给内部函数的变量提供了一定的安全性。此外，由于内部函数可以访问外部函数的作用域，因此当内部函数生存周期大于外部函数时，外部函数中定义的变量和函数的生存周期将比内部函数执行时间长。<font color="red">当内部函数以某一种方式被任何一个外部函数作用域访问时，一个闭包就产生了</font>
先看一个简单地栗子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">pet</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">//外部函数定义了一个变量&quot;name&quot;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            
    <span class="token comment">//内部函数可以访问 外部函数定义的&quot;name&quot;</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
  <span class="token comment">// 返回这个内部函数，从而将其暴露在外部函数作用域</span>
  <span class="token keyword">return</span> getName<span class="token punctuation">;</span>               
<span class="token punctuation">}</span><span class="token punctuation">;</span>
myPet <span class="token operator">=</span> <span class="token function">pet</span><span class="token punctuation">(</span><span class="token string">&quot;Vivie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token function">myPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 返回结果 &quot;Vivie&quot;                </span>
</code></pre></div><p>下面是一个复杂一点的栗子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">createPet</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> sex<span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      name <span class="token operator">=</span> newName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token function-variable function">getSex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token function-variable function">setSex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newSex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> newSex <span class="token operator">==</span> <span class="token string">&quot;string&quot;</span> 
        <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>newSex<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;male&quot;</span> <span class="token operator">||</span> newSex<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;female&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sex <span class="token operator">=</span> newSex<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> pet <span class="token operator">=</span> <span class="token function">createPet</span><span class="token punctuation">(</span><span class="token string">&quot;Vivie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pet<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// Vivie</span>

pet<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Oliver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pet<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span><span class="token string">&quot;male&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pet<span class="token punctuation">.</span><span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// male</span>
pet<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// Oliver</span>
</code></pre></div><p>在上面的代码中，外部函数的name变量对内嵌函数来说是可取得的，而除了通过内嵌函数本身，没有其它任何方法可以取得内嵌的变量。内嵌函数的内嵌变量就像内嵌函数的保险柜。它们会为内嵌函数保留“稳定”——而又安全——的数据参与运行。而这些内嵌函数甚至不会被分配给一个变量，或者不必一定要有名字
<br></p> <p>尽管有上述优点，使用闭包时仍然要小心避免一些陷阱。如果一个闭包的函数定义了一个和外部函数的某个变量名称相同的变量，那么这个闭包将无法引用外部函数的这个变量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">createPet</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// Outer function defines a variable </span>
                                     called <span class="token string">&quot;name&quot;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// Enclosed function also defines a </span>
                                    variable called <span class="token string">&quot;name&quot;</span>
      name <span class="token operator">=</span> name<span class="token punctuation">;</span>               <span class="token comment">// ??? How do we access the &quot;name” </span>
                                    defined by the outer <span class="token keyword">function</span> <span class="token operator">??</span><span class="token operator">?</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>闭包只能取得包含函数的最后一个值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">return</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> funcs <span class="token operator">=</span> <span class="token function">createArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> funcs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>funcs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;br /&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><font color="red">
1. 这几个函数都保留着对同一个外部函数的变量对象的引用<br>
2. 因为闭包函数“延迟调用”的特性，而关键变量值i的获取是在闭包函数调用（f也即uncs\[i]()）的时候才从外部函数的变量对象中获取，而这个时候，外部函数早就完成for循环使 i =10了 !!!
</font></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b1624e8e.js" defer></script><script src="/assets/js/2.12e8692c.js" defer></script><script src="/assets/js/38.635da6e1.js" defer></script>
  </body>
</html>
